Version 4.1
SHEET 1 964 996
WIRE -1840 -256 -2000 -256
WIRE -1552 -256 -1840 -256
WIRE -1520 -256 -1552 -256
WIRE -1408 -256 -1440 -256
WIRE -1168 -256 -1408 -256
WIRE -560 -256 -1168 -256
WIRE -352 -256 -560 -256
WIRE -272 -256 -352 -256
WIRE -224 -256 -272 -256
WIRE -176 -256 -224 -256
WIRE 32 -256 -176 -256
WIRE 80 -256 32 -256
WIRE 128 -256 80 -256
WIRE 240 -256 128 -256
WIRE -1136 -192 -1280 -192
WIRE -1056 -192 -1072 -192
WIRE -560 -144 -560 -256
WIRE 32 -144 32 -256
WIRE 240 -144 240 -256
WIRE -1552 -128 -1552 -256
WIRE -352 -128 -352 -256
WIRE -176 -128 -176 -256
WIRE 128 -128 128 -256
WIRE -224 -112 -224 -256
WIRE 80 -112 80 -256
WIRE -1280 -96 -1280 -192
WIRE -1136 -96 -1200 -96
WIRE -1056 -96 -1056 -192
WIRE -1056 -96 -1072 -96
WIRE -1840 -32 -1840 -256
WIRE -1168 -32 -1168 -256
WIRE -1408 -16 -1408 -256
WIRE -1392 -16 -1408 -16
WIRE -1280 -16 -1280 -96
WIRE -1280 -16 -1312 -16
WIRE -1200 -16 -1280 -16
WIRE -1056 0 -1056 -96
WIRE -1056 0 -1136 0
WIRE -944 0 -1056 0
WIRE -848 0 -944 0
WIRE -704 0 -768 0
WIRE -560 0 -560 -64
WIRE -560 0 -704 0
WIRE -496 0 -560 0
WIRE -352 0 -352 -64
WIRE -352 0 -416 0
WIRE -304 0 -352 0
WIRE -256 0 -304 0
WIRE -224 0 -224 -64
WIRE -224 0 -256 0
WIRE -176 0 -176 -48
WIRE -96 0 -176 0
WIRE 32 0 32 -64
WIRE 32 0 -32 0
WIRE 80 0 80 -64
WIRE 80 0 32 0
WIRE 128 0 128 -48
WIRE 240 0 240 -64
WIRE 240 0 128 0
WIRE 336 0 240 0
WIRE -2000 16 -2000 -256
WIRE -1552 16 -1552 -48
WIRE -1200 16 -1552 16
WIRE -1552 96 -1552 16
WIRE -304 112 -304 0
WIRE -112 112 -304 112
WIRE 128 112 128 0
WIRE 128 112 -48 112
WIRE 128 192 128 112
WIRE -1840 256 -1840 48
WIRE -1712 256 -1840 256
WIRE -1552 256 -1552 176
WIRE -1552 256 -1712 256
WIRE -1168 256 -1168 32
WIRE -1168 256 -1552 256
WIRE -1840 320 -1840 256
WIRE 128 320 128 272
WIRE 192 320 128 320
WIRE 272 320 192 320
WIRE 464 320 352 320
WIRE 624 320 464 320
WIRE 128 384 128 320
WIRE 128 384 -16 384
WIRE 464 400 464 320
WIRE 624 400 624 320
WIRE -16 416 -16 384
WIRE 128 416 128 384
WIRE -2000 464 -2000 96
WIRE -1840 464 -1840 400
WIRE -16 544 -16 496
WIRE 128 544 128 480
WIRE 464 544 464 464
WIRE 624 544 624 480
FLAG -2000 464 0
FLAG -256 0 GATE
FLAG -272 -256 SOURCE
FLAG 336 0 DRAIN
FLAG -1840 464 0
FLAG 128 544 0
FLAG -16 544 0
FLAG 624 544 0
FLAG 192 320 OUT
FLAG -1712 256 VBUS_MINUS_VBIAS
FLAG -944 0 OUT_INTEG
FLAG -704 0 INJ
FLAG 464 544 0
DATAFLAG -288 112 ""
DATAFLAG 128 112 ""
DATAFLAG -1072 -256 ""
SYMBOL g 128 -32 M180
SYMATTR InstName G1
SYMATTR Value {-Kp}
SYMBOL res 224 -48 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL e -176 -32 M180
SYMATTR InstName E1
SYMATTR Value 1.0
SYMBOL res 48 -160 M0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL diode -32 16 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value Dthreshold
SYMBOL res 112 176 R0
SYMATTR InstName ROUT
SYMATTR Value 1µ
SYMBOL voltage -2000 0 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VBUS
SYMATTR Value 30
SYMBOL cap -336 -64 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName CGS
SYMATTR Value {Cgs}
SYMBOL cap -112 128 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName CGD
SYMATTR Value {Cgd}
SYMBOL res -1536 -240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RSNS
SYMATTR Value 10m
SYMBOL voltage -1840 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VBIAS
SYMATTR Value 10
SYMBOL res -1856 304 R0
SYMATTR InstName R3
SYMATTR Value 10Meg
SYMBOL OpAmps\\UniversalOpAmp3a -1168 0 R0
SYMATTR InstName U1
SYMATTR SpiceLine Ilimit=25m Rail=0 Vos=0 Phimargin=65
SYMBOL res -1568 80 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -1568 -144 R0
SYMATTR InstName R6
SYMATTR Value 60
SYMBOL res -1296 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -1184 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 24k
SYMBOL cap -1072 -112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 0.01µ
SYMBOL cap 112 416 R0
SYMATTR InstName C2
SYMATTR Value 1.8µ
SYMBOL res -32 400 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 608 384 R0
SYMATTR InstName RLOAD
SYMATTR Value 4.7
SYMBOL voltage -752 0 R90
WINDOW 0 -61 57 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 -39 55 VBottom 2
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 0
SYMATTR Value2 AC 1
SYMBOL res 368 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RLOAD_SNS
SYMATTR Value 1µ
SYMBOL cap 448 400 R0
SYMATTR InstName CLOAD
SYMATTR Value 1m
SYMBOL res -400 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG
SYMATTR Value 100
SYMBOL res -576 -160 R0
SYMATTR InstName R10
SYMATTR Value 15k
SYMBOL cap -1072 -208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 1000p
TEXT -1368 712 Left 2 !.model Dthreshold D(Ron=1 Roff=10Meg Vfwd={Vth} Vrev=1
TEXT -1368 792 Left 2 ;.dc V1 0 -10 10m
TEXT -1368 584 Left 2 !.param Vth = 4\n.param Kp = 10\n.param Cgs = 20n\n.param Cgd = 5n
TEXT -1368 824 Left 2 !.ac dec 1k 1 10Meg
TEXT -1368 896 Left 2 !.step param Cgs list 1n 5n 10n 20n 50n\n.step param Cds list 1n 5n 10n\n.step param Kp list 3 5 10 25 50
