Version 4.1
SHEET 1 964 1640
WIRE -1840 -256 -2000 -256
WIRE -1552 -256 -1840 -256
WIRE -1520 -256 -1552 -256
WIRE -1408 -256 -1440 -256
WIRE -1168 -256 -1408 -256
WIRE -560 -256 -1168 -256
WIRE -336 -256 -560 -256
WIRE 128 -256 -336 -256
WIRE -1136 -192 -1280 -192
WIRE -1056 -192 -1072 -192
WIRE -560 -144 -560 -256
WIRE -1552 -128 -1552 -256
WIRE -1280 -96 -1280 -192
WIRE -1136 -96 -1200 -96
WIRE -1056 -96 -1056 -192
WIRE -1056 -96 -1072 -96
WIRE -1840 -32 -1840 -256
WIRE -1168 -32 -1168 -256
WIRE -1408 -16 -1408 -256
WIRE -1392 -16 -1408 -16
WIRE -1280 -16 -1280 -96
WIRE -1280 -16 -1312 -16
WIRE -1200 -16 -1280 -16
WIRE 128 -16 128 -256
WIRE -1056 0 -1056 -96
WIRE -1056 0 -1136 0
WIRE -944 0 -1056 0
WIRE -848 0 -944 0
WIRE -704 0 -768 0
WIRE -560 0 -560 -64
WIRE -560 0 -704 0
WIRE -496 0 -560 0
WIRE -336 0 -416 0
WIRE 80 0 -336 0
WIRE -2000 16 -2000 -256
WIRE -1552 16 -1552 -48
WIRE -1200 16 -1552 16
WIRE -1552 96 -1552 16
WIRE 128 96 128 80
WIRE 224 96 128 96
WIRE 128 192 128 96
WIRE -1840 256 -1840 48
WIRE -1712 256 -1840 256
WIRE -1552 256 -1552 176
WIRE -1552 256 -1712 256
WIRE -1168 256 -1168 32
WIRE -1168 256 -1552 256
WIRE -1840 320 -1840 256
WIRE 128 320 128 272
WIRE 192 320 128 320
WIRE 272 320 192 320
WIRE 464 320 352 320
WIRE 624 320 464 320
WIRE 752 320 624 320
WIRE 128 384 128 320
WIRE 128 384 -16 384
WIRE 464 400 464 320
WIRE 624 400 624 320
WIRE -16 416 -16 384
WIRE 128 416 128 384
WIRE -2000 464 -2000 96
WIRE -1840 464 -1840 400
WIRE -16 544 -16 496
WIRE 128 544 128 480
WIRE 464 544 464 464
WIRE 624 544 624 480
FLAG -2000 464 0
FLAG -1840 464 0
FLAG 128 544 0
FLAG -16 544 0
FLAG 624 544 0
FLAG 192 320 OUT
FLAG -1712 256 VBUS_MINUS_VBIAS
FLAG -944 0 OUT_INTEG
FLAG -704 0 INJ
FLAG 464 544 0
FLAG -336 -256 SOURCE
FLAG -336 0 GATE
FLAG 224 96 OUT
FLAG 752 320 LOAD
DATAFLAG -1072 -256 ""
DATAFLAG -144 0 ""
DATAFLAG -128 -256 ""
DATAFLAG 128 144 ""
SYMBOL res 112 176 R0
SYMATTR InstName ROUT
SYMATTR Value 1µ
SYMBOL voltage -2000 0 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VBUS
SYMATTR Value 30
SYMBOL res -1536 -240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RSNS
SYMATTR Value 10m
SYMBOL voltage -1840 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VBIAS
SYMATTR Value 10
SYMBOL res -1856 304 R0
SYMATTR InstName R3
SYMATTR Value 10Meg
SYMBOL OpAmps\\UniversalOpAmp3a -1168 0 R0
SYMATTR InstName U1
SYMATTR SpiceLine Ilimit=25m Rail=0 Vos=0 Phimargin=65
SYMBOL res -1568 80 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -1568 -144 R0
SYMATTR InstName R6
SYMATTR Value 60
SYMBOL res -1296 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -1184 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 24k
SYMBOL cap -1072 -112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 0.01µ
SYMBOL cap 112 416 R0
SYMATTR InstName C2
SYMATTR Value 1.8µ
SYMBOL res -32 400 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 608 384 R0
SYMATTR InstName RLOAD
SYMATTR Value 4.7
SYMBOL voltage -752 0 R90
WINDOW 0 -61 57 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 -39 55 VBottom 2
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 0
SYMATTR Value2 AC 1
SYMBOL res 368 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RLOAD_SNS
SYMATTR Value 1µ
SYMBOL cap 448 400 R0
SYMATTR InstName CLOAD
SYMATTR Value 1m
SYMBOL res -400 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG
SYMATTR Value 100
SYMBOL res -576 -160 R0
SYMATTR InstName R10
SYMATTR Value 15k
SYMBOL cap -1072 -208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 1000p
SYMBOL pmos 80 80 M180
SYMATTR InstName M1
SYMATTR Value PWR_PMOS
SYMATTR Prefix X
TEXT -1120 112 Left 2 !* Simple P-Channel MOSFET Model\n*If VSG > VTH, FET in cutoff and ID = 0\n*If VSG > VTH and VSD > VSG by VTH, FET in Active region of operation\n*If VSG > VSD by VTH, FET fully enhanced\n \n* External Node Designations\n* Node 1 -> Drain\n* Node 2 -> Gate\n* Node 3 -> Source\n \n.SUBCKT PWR_PMOS D G S\nE1 N001 G S G 1.0\nR2 G N002 1k\nD2 N001 N002 Dthreshold\nCGS G S {Cgs}\nCGD G D {Cgd}\nRO D_PRIME S 10k\nE2 OV 0 N002 G 1.0\nBI_IACTIVE S D_PRIME I={K*V(OV)*V(OV)}\nB2 N003 0 V={V(VSG)-V(VSD)}\nRDS D_PRIME D {Rdson}\nD1 N003 ENH Dthreshold\nR4 ENH 0 1k\nBI_ENHANCED D_PRIME S I={K*V(ENH)*V(ENH)}\nB1 VSG 0 V={V(S)-V(G)}\nB3 VSD 0 V={V(S)-V(D)}\nDbody D_PRIME S Dbody\nR100 G 0 100Meg\nR101 D 0 100Meg\nR102 S 0 100Meg\n.param Vth = 2\n.param K = 1\n.param Cgs = 13n\n.param Cgd = 1n\n.param Rdson = 50m\n.model Dthreshold D(Ron=0 Roff=100Meg Vfwd={Vth})\n.model Dbody D(Ron=1 Roff=100k Vfwd=0.6)\n.backanno\n.end
TEXT -40 624 Left 2 !.ac dec 1k 1 10Meg
